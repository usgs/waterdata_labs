---
date: 2020-03 -14
slug: about-graph-image-api
title: Graph Image API
description: The graph image API allows users to download an image version of the new dynamic hydrograph that is on the next generation monitoring location pages.
thumbnail_path: "https://labs.waterdata.usgs.gov/api/graph-images/monitoring-location/09380000/?parameterCode=00060&width=300&period=P7D"
thumbnail_alt: "A line graph showing 7 days of hydrological data.  The line is orange, with black axes"
keywords:
  - Graph
  - Image
  - API
image: "https://labs.waterdata.usgs.gov/api/graph-images/monitoring-location/09380000/?parameterCode=00060&width=300&period=P7D"
containerclass: grid-container
---

Recently, the Water Data for the Nation (WDFN) development [released a new real-time site page](https://waterdata.usgs.gov/blog/wdfn-tng/). One of the[ most common pieces of feedback](https://waterdata.usgs.gov/blog/wdfn-firstlook/) that we received about the hydrograph on [the new monitoring location pages](https://waterdata.usgs.gov/monitoring-location/09380000/) was that users need a way to save an image of a given hydrograph. In the [classic pages](https://waterdata.usgs.gov/nwis/uv?site_no=09380000)[,](https://waterdata.usgs.gov/nwis/uv?site_no=09380000) these graphs are already images, generated by the server using a command line tool called [gnuplot](http://www.gnuplot.info/). It was easy enough to expose the endpoint that generated those images:

[https://waterdata.usgs.gov/nwisweb/graph?agency_cd=USGS&site_no=09380000&parm_cd=00060&period=7](https://waterdata.usgs.gov/nwisweb/graph?agency_cd=USGS&site_no=09380000&parm_cd=00060&period=7)
{{< figure src="https://waterdata.usgs.gov/nwisweb/graph?agency_cd=USGS&site_no=09380000&parm_cd=00060&period=7" title="Legacy graph image, rendered server-side using gnu-plot." >}}

These images are all over the internet, and an important service provided by the Water Data for the Nation project.  Unfortunately, the structure of this approach was showing its age.  Users wanted more than just static plots on the water data pages, they wanted interactive figures, which we have built in the [new monitoring location pages](https://waterdata.usgs.gov/blog/wdfn-tng/).  At the same time, one of the most commonly requested features on new monitoring location pages was an image version of the new, interactive hydrograph, so we know we needed to do something.

However, the new approach to building graphs is not nearly so straightforward to make an image from, as they are dynamically generated in the web browser using a tool called [D3](https://d3js.org/). Replicating the environment of a browser was a non-trivial task, but with the major advances in browser automation with tools like [puppeteer](https://developers.google.com/web/tools/puppeteer/), we were able to generate [a reasonable solution](https://github.com/usgs/waterdataui/tree/master/graph-server).

So now, it is possible to render a contemporary graph from water data for the nation, while only needing to use the venerable `<img>` tag, as you can see below:


{{< highlight html >}}
<figure>
    <img 
    src="https://labs.waterdata.usgs.gov/api/graph-images/monitoring-location/09380000/?parameterCode=00060"
    alt="A line graph showing 7 days of hydrological data.  The line is orange, with black axes"
    >
    <figcaption>
      Future graph image, rendered server-side using client-side code with puppeteer
    </figcaption>
</figure>
{{< / highlight >}}



{{< figure src="https://labs.waterdata.usgs.gov/api/graph-images/monitoring-location/09380000/?parameterCode=00060" alt="A line graph showing 7 days of hydrological data.  The line is orange, with black axes" title="Future graph image, rendered server-side using client-side code with puppeteer" >}}

[https://labs.waterdata.usgs.gov/api/graph-images/monitoring-location/09380000/?parameterCode=00060](https://labs.waterdata.usgs.gov/api/graph-images/monitoring-location/09380000/?parameterCode=00060)



The graph image project is a work in progress and this is a first step to meeting usersâ€™ requests for 
easy image downloads. We have added [openAPI based documentation](https://labs.waterdata.usgs.gov/api/graph-images/api-docs/) so that users can easily see how to customize
the images using available query parameters. The user can now customize the size, title, time period, and time series ID.

In the future, we plan to add additional features to the graph image server, including

* more gracefully handling when no data are returned
* additional data elements
* different kinds of graphs beyond the basic hydrograph
* making it possible to embed dynamic content, rather than just images, in third party pages.


Try it out and [let us know](https://water.usgs.gov/contact/gsanswers?pemail=gs-w-ks_NWISWeb_Data_Inquiries&subject=Site+Number%3A+07144100&viewnote=%3CH1%3EUSGS+NWIS+Feedback+Request%3C%2FH1%3E%3Cp%3E%3Cb%3EPlease+enter+a+subject+in+the+form+below+that+briefly+summarizes+your+request%3C%2Fb%3E%3C%2Fp%3E) how it works for you!
